let dashboardKeys={"00000001-bbbb-dddd-aaaa-00000001":"Tenant Overview Dashboard","00000002-bbbb-dddd-aaaa-00000001":"[Application Name] Overview Dashboard","00000003-bbbb-dddd-aaaa-00000001":"[Application Name] Key User Action Dashboard","00000004-bbbb-dddd-aaaa-00000001":"Synthetic Dashboard - Monitor View","00000005-bbbb-dddd-aaaa-00000001":"Synthetic Dashboard - Performance","00000006-bbbb-dddd-aaaa-00000001":"Synthetic Dashboard - Availability","00000007-bbbb-dddd-aaaa-00000001":"Insights Overview Dashboard","00000008-bbbb-dddd-aaaa-00000001":"Funnel Dashboard"},foundDashboards={"00000001":0,"00000002":0,"00000003":0,"00000004":0,"00000005":0,"00000006":0,"00000007":0,"00000008":0},createdApplications={},bindDarbyEvents=()=>{document.querySelector("#generateDARBIE").addEventListener("click",function(){configureDashboards("Generate")}),document.querySelector("#overwriteDARBIE").addEventListener("click",function(){configureDashboards("Overwrite")}),document.querySelector("#deleteDARBIE").addEventListener("click",function(){deleteDashboards()}),document.querySelector("#saveDashboardConfigDARBIE").addEventListener("click",function(){document.querySelector("#saveDashboardConfigDARBIE").innerText="Saved!",document.querySelector("#saveDashboardConfigDARBIE").disabled=!0,document.querySelector("#container_DARBIEConfiguration").className="container tab-pane fade",document.querySelector("#container_DARBIE").className="container tab-pane active"});let e=document.querySelectorAll('input[list^="CGs"]'),t=document.querySelectorAll('input[list^="KUAs"]');for(let i=0;i<e.length;i++)e[i].addEventListener("change",function(n){t[i].disabled=""!==e[i].value}),t[i].addEventListener("change",function(n){e[i].disabled=""!==t[i].value});let i=document.querySelectorAll('input[id^="customCheck"]'),n=document.querySelectorAll('input[list^="KUA"]'),a=document.querySelectorAll(".funnelChoices");for(let e=0;e<i.length;e++)i[e].addEventListener("change",function(t){for(let t=a[e].children.length-1;t>1;t--)"none"===a[e].children[t].style.display&&"DATALIST"!==a[e].children[t].tagName?(a[e].children[t].style.display="block",a[e].children[t].value=""):"DATALIST"!==a[e].children[t].tagName&&a[e].children[t].attributes.list&&(a[e].children[t].attributes.list.value.indexOf("CGs")>-1||a[e].children[t].attributes.list.value.indexOf("funnelAppName")>-1)&&(a[e].children[t].style.display="none",a[e].children[t].value="");n[e].disabled=!1});let r=document.querySelectorAll("input[list^=funnelAppName");for(let e=0;e<r.length;e++)r[e].addEventListener("input",function(t){r[e].value.length>0?r[e].style["background-color"]="rgba(255, 0, 0, 0)":r[e].style["background-color"]="rgba(255, 0, 0, 0.17)"});document.querySelector("#addRowDARBIE").addEventListener("click",function(e){document.querySelector('#funnelList > .row[style="margin-top:5px; display:none;"]')&&(document.querySelector('#funnelList > .row[style="margin-top:5px; display:none;"]').style.display="",document.querySelector('#funnelList > .row[style="margin-top:5px; display:none;"]')||(document.querySelector("#addRowDARBIE").style.display="none"))}),document.querySelector("#configureDARBIE").addEventListener("click",function(){if(!0===document.querySelector("#saveDashboardConfigDARBIE").disabled)document.querySelector("#saveDashboardConfigDARBIE").innerText="Apply",document.querySelector("#saveDashboardConfigDARBIE").disabled=!1;else{document.querySelector("#appCheckDARBIE").innerText="",document.querySelector("#funnelList").hidden=!0,document.querySelector("#applicationCheckboxesDARBIE").innerHTML="";let e=document.querySelectorAll("#funnelList datalist option");for(opt of e)opt.remove();let t=document.querySelectorAll("#funnelList input");for(let e of t)e.value=null,e.disabled=!1}gatherConfigInfoDARBIE()}),document.querySelector("#container_DARBIE").addEventListener("click",function(){document.querySelector("#configureDARBIE").className="btn btn-primary form-control"}),document.querySelector("#container_DNA").addEventListener("click",function(){document.querySelector("#configureDARBIE").className="btn btn-primary form-control"}),document.querySelector("#backBtnDARBIE").addEventListener("click",function(){document.querySelector("#container_DARBIEConfiguration").className="container tab-pane fade",document.querySelector("#container_DARBIE").className="container tab-pane active"}),document.querySelector("#apiTokenDARBIE").addEventListener("change",async function(){if(dataObject.managed){let e=dataObject.fullURL.split("/e/");dataObject.fullURL=e[0]+"/e/"+e[1].split("/")[0]}else dataObject.fullURL=dataObject.fullURL.split(".com")[0]+".com";let e=document.getElementById("apiTokenDARBIE").value;if(""!==e){let t=await fetch(dataObject.fullURL+"/api/v1/tokens/lookup",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Api-Token "+e},body:JSON.stringify({token:e})}).then(e=>e.json()).then(e=>e.scopes).catch(e=>res.status(401).send({success:!1,error:{message:"Failed to get details about API token"}}));t&&-1===t.indexOf("WriteConfig")&&(document.querySelector("#bottomDARBIE").innerText='Your API Token is missing the "Write configuration" scope!',document.querySelector('a[href="#bottomDARBIE"]').click())}}),document.querySelector("#publicOpt").addEventListener("click",function(){document.querySelector("#publicOpt").checked&&(document.querySelector("#privateOpt").checked=!1)}),document.querySelector("#privateOpt").addEventListener("click",function(){document.querySelector("#privateOpt").checked&&(document.querySelector("#publicOpt").checked=!1)})};function dTenantOverview(e){let t=remoteJSON["/includes/json/tenantOverview.json"];t.dashboardMetadata.owner=dataObject.User;let i={name:"Markdown",tileType:"MARKDOWN",configured:!0,bounds:{top:114,left:1596,width:304,height:988},tileFilter:{},markdown:""};for(let t in e)t.indexOf("00000002-")>-1&&(i.markdown+="- ["+e[t]+"](#dashboard;id="+t+";gtf=l_2_HOURS;gf=all)\n");t.tiles.push(i);foundDashboards["00000006"]>0&&t.tiles.push({name:"Markdown",tileType:"MARKDOWN",configured:!0,bounds:{top:0,left:0,width:342,height:38},tileFilter:{},markdown:"## [Synthetic Avail. Dashboard](#dashboard;id=00000006-bbbb-dddd-aaaa-"+foundDashboards["00000006"].toString().padStart(8,"0")+";gtf=l_2_HOURS;gf=all) "}),foundDashboards["00000005"]>0&&t.tiles.push({name:"Markdown",tileType:"MARKDOWN",configured:!0,bounds:{top:0,left:380,width:342,height:38},tileFilter:{},markdown:"## [Synthetic Perf. Dashboard](#dashboard;id=00000005-bbbb-dddd-aaaa-"+foundDashboards["00000005"].toString().padStart(8,"0")+";gtf=l_2_HOURS;gf=all) "}),foundDashboards["00000004"]>0&&t.tiles.push({name:"Markdown",tileType:"MARKDOWN",configured:!0,bounds:{top:0,left:760,width:342,height:38},tileFilter:{},markdown:"## [Synthetic Monitor View](#dashboard;id=00000004-bbbb-dddd-aaaa-"+foundDashboards["00000004"].toString().padStart(8,"0")+";gtf=l_2_HOURS;gf=all)"});return document.querySelector("#publicOpt").checked&&(t.dashboardMetadata.shared=!0,t.dashboardMetadata.sharingDetails.published=!0),t}function dAppOverview(e,t){let i=remoteJSON["/includes/json/AppOverview.json"];return i.tiles[24].markdown="## [Application Key User Action Dashboard](#dashboard;id=00000003-bbbb-dddd-aaaa-"+t+";gtf=l_2_HOURS;gf=all) ",i.id="00000002-bbbb-dddd-aaaa-"+e,i.dashboardMetadata.owner=dataObject.User,document.querySelector("#publicOpt").checked&&(i.dashboardMetadata.shared=!0,i.dashboardMetadata.sharingDetails.published=!0),i}function dAppKUAs(e,t,i){let n=remoteJSON["/includes/json/AppKUAs.json"];n.id="00000003-bbbb-dddd-aaaa-"+e,n.dashboardMetadata.owner=dataObject.User,n.tiles[3].markdown="## [Application Overview Dashboard](#dashboard;id=00000002-bbbb-dddd-aaaa-"+t+";gtf=l_2_HOURS;gf=all)";let a=114,r=0,o=418,l=304,d=[],c=[];for(let e=0;e<i.length;e++){"Load"===document.querySelector("#appBodyDARBIE input#"+i[e]).attributes.dttype.value?c.push(i[e]):d.push(i[e])}for(let e=0;e<c.length;e++){let t=document.querySelector("#"+c[e]).attributes.dtname.value,i=(document.querySelector("#"+c[e]).attributes.dttype.value,c[e]+"Â¦APPLICATION_METHODÂ»"+c[e]+"Â»truebuiltin:apps.web.action.count.load.browser|NONE|TOTAL|BAR|APPLICATION_METHOD"),d=c[e]+"Â¦APPLICATION_METHODÂ»"+c[e]+"Â»truebuiltin:apps.web.action.visuallyComplete.load.browser|AVG|TOTAL|LINE|APPLICATION_METHOD";e%3==0&&0!==e&&(a+=304),r=e%3*418,n.tiles.push({name:"Custom chart",tileType:"CUSTOM_CHARTING",configured:!0,bounds:{top:a,left:r,width:o,height:l},tileFilter:{},filterConfig:{type:"MIXED",customName:t,defaultName:"Custom chart",chartConfig:{legendShown:!0,type:"TIMESERIES",series:[{metric:"builtin:apps.web.action.visuallyComplete.load.browser",aggregation:"AVG",type:"LINE",entityType:"APPLICATION_METHOD",dimensions:[{id:"0",name:"dt.entity.application_method",values:[],entityDimension:!0}],sortAscending:!1,sortColumn:!1,aggregationRate:"TOTAL"},{metric:"builtin:apps.web.action.count.load.browser",aggregation:"NONE",type:"BAR",entityType:"APPLICATION_METHOD",dimensions:[{id:"0",name:"dt.entity.application_method",values:[],entityDimension:!0}],sortAscending:!1,sortColumn:!0,aggregationRate:"TOTAL"}],resultMetadata:{[i]:{lastModified:1591670314333,customColor:"#008cdb"},[d]:{lastModified:1591670318306,customColor:"#ef651f"}}},filtersPerEntityType:{APPLICATION_METHOD:{SPECIFIC_ENTITIES:[c[e]]}}}})}n.tiles.push({name:"User Sessions Query",tileType:"DTAQL",configured:!0,bounds:{top:a+=304,left:0,width:1254,height:266},tileFilter:{},customName:"Slowest Key User Actions",query:'select useraction.name AS "Page Name", AVG(useraction.visuallyCompleteTime) AS "Visually Complete Time" FROM useraction where keyUserAction=true AND type="Load" AND application="[Application Name]" GROUP BY useraction.name ORDER BY AVG(useraction.visuallyCompleteTime) DESC LIMIT 10',type:"TABLE",limit:50}),n.tiles.push({name:"XHR",tileType:"HEADER",configured:!0,bounds:{top:a+=304,left:0,width:1254,height:38},tileFilter:{}}),a+=38,r=0,o=418,l=304;for(let e=0;e<d.length;e++){let t=document.querySelector("#"+d[e]).attributes.dtname.value,i=(document.querySelector("#"+d[e]).attributes.dttype.value,d[e]+"Â¦APPLICATION_METHODÂ»"+d[e]+"Â»truebuiltin:apps.web.action.count.xhr.browser|NONE|TOTAL|BAR|APPLICATION_METHOD"),c=d[e]+"Â¦APPLICATION_METHODÂ»"+d[e]+"Â»truebuiltin:apps.web.action.duration.xhr.browser|AVG|TOTAL|LINE|APPLICATION_METHOD";e%3==0&&0!==e&&(a+=304),r=e%3*418,n.tiles.push({name:"Custom chart",tileType:"CUSTOM_CHARTING",configured:!0,bounds:{top:a,left:r,width:o,height:l},tileFilter:{},filterConfig:{type:"MIXED",customName:t,defaultName:"Custom chart",chartConfig:{legendShown:!0,type:"TIMESERIES",series:[{metric:"builtin:apps.web.action.duration.xhr.browser",aggregation:"AVG",type:"LINE",entityType:"APPLICATION_METHOD",dimensions:[{id:"0",name:"dt.entity.application_method",values:[],entityDimension:!0}],sortAscending:!1,sortColumn:!1,aggregationRate:"TOTAL"},{metric:"builtin:apps.web.action.count.xhr.browser",aggregation:"NONE",type:"BAR",entityType:"APPLICATION_METHOD",dimensions:[{id:"0",name:"dt.entity.application_method",values:[],entityDimension:!0}],sortAscending:!1,sortColumn:!0,aggregationRate:"TOTAL"}],resultMetadata:{[i]:{lastModified:1591670707370,customColor:"#008cdb"},[c]:{lastModified:1591670692621,customColor:"#ef651f"}}},filtersPerEntityType:{APPLICATION_METHOD:{SPECIFIC_ENTITIES:[d[e]]}}}})}return n.tiles.push({name:"User Sessions Query",tileType:"DTAQL",configured:!0,bounds:{top:a+=304,left:0,width:1254,height:266},tileFilter:{},customName:"Slowest XHR Key User Actions",query:'select useraction.name AS "XHR Action Name", AVG(useraction.duration) AS "Action Duration Time" FROM useraction where keyUserAction=true AND type="Xhr" AND application="[Application Name]" GROUP BY useraction.name ORDER BY AVG(useraction.duration) DESC LIMIT 10',type:"TABLE",limit:50}),document.querySelector("#publicOpt").checked&&(n.dashboardMetadata.shared=!0,n.dashboardMetadata.sharingDetails.published=!0),n}function dSyntheticMonitorView(e){let t=remoteJSON["/includes/json/SyntheticMonitorView.json"];t.id="00000004-bbbb-dddd-aaaa-"+e,t.dashboardMetadata.owner=dataObject.User,t.tiles[1].markdown="## [Synthetic Avail. Dashboard](#dashboard;id=00000006-bbbb-dddd-aaaa-"+foundDashboards["00000006"].toString().padStart(8,"0")+";gtf=l_2_HOURS;gf=all) ",t.tiles[2].markdown="## [Synthetic Avail. Dashboard](#dashboard;id=00000006-bbbb-dddd-aaaa-"+foundDashboards["00000005"].toString().padStart(8,"0")+";gtf=l_2_HOURS;gf=all) ";let i=76,n=0;for(let e=0;e<listenerOrder.Synthetic.length;e++)0!==e&&e%4==0&&(i+=304,n=0),t.tiles.push({name:"Browser monitor",tileType:"SYNTHETIC_SINGLE_WEBCHECK",configured:!0,bounds:{top:i,left:n,width:304,height:304},tileFilter:{},assignedEntities:[listenerOrder.Synthetic[e][0]],excludeMaintenanceWindows:!0}),n+=304;return document.querySelector("#publicOpt").checked&&(t.dashboardMetadata.shared=!0,t.dashboardMetadata.sharingDetails.published=!0),t}function dSyntheticPerf(e,t){let i=remoteJSON["/includes/json/SyntheticPerf.json"];return i.id="00000005-bbbb-dddd-aaaa-"+e,i.dashboardMetadata.owner=dataObject.User,i.tiles[11].markdown="## [Synthetic Avail. Dashboard](#dashboard;id=00000006-bbbb-dddd-aaaa-"+foundDashboards["00000006"].toString().padStart(8,"0")+";gtf=l_2_HOURS;gf=all) ",i.tiles[12].markdown="## [Monitor View Dashboard](#dashboard;id=00000004-bbbb-dddd-aaaa-"+t+";gtf=l_2_HOURS;gf=all) ",document.querySelector("#publicOpt").checked&&(i.dashboardMetadata.shared=!0,i.dashboardMetadata.sharingDetails.published=!0),i}function dSyntheticAvail(e,t){let i=remoteJSON["/includes/json/SyntheticAvail.json"];return i.id="00000006-bbbb-dddd-aaaa-"+e,i.dashboardMetadata.owner=dataObject.User,i.tiles[11].markdown="## [Synthetic Perf. Dashboard](#dashboard;id=00000005-bbbb-dddd-aaaa-"+foundDashboards["00000005"].toString().padStart(8,"0")+";gtf=l_2_HOURS;gf=all) ",i.tiles[12].markdown="## [Monitor View Dashboard](#dashboard;id=00000004-bbbb-dddd-aaaa-"+t+";gtf=l_2_HOURS;gf=all) ",document.querySelector("#publicOpt").checked&&(i.dashboardMetadata.shared=!0,i.dashboardMetadata.sharingDetails.published=!0),i}function dInsightsOverview(e){let t=remoteJSON["/includes/json/InsightsOverview.json"];return t.dashboardMetadata.owner=dataObject.User,t.tiles[3].markdown="## Your Business Insight team\n\nYour Business Insights Analyst is ["+e+"](https://dynatrace.com). \n\nInquiries can be directed at them and [InsightsSupport@dynatrace.com](https://dynatrace.com)",document.querySelector("#publicOpt").checked&&(t.dashboardMetadata.shared=!0,t.dashboardMetadata.sharingDetails.published=!0),t}function dFunnelDashboard(e,t){let n=remoteJSON["/includes/json/FunnelDashboard.json"],a=[],r=[],o=[],l=[],d=[],c=[],s=266,u=228,p=document.querySelectorAll('#funnelList input.col-md-4[list^="KUAs"]'),b=document.querySelectorAll('#funnelList input.col-md-4[list^="CGs"]'),h=document.querySelectorAll('#funnelList input.col-md-4[list^="funnelAppName"]'),m=document.querySelectorAll("#funnelList input.col-md-2");for(i=0;i<p.length;i++){var A="",f="",E="",g="";if(""!==p[i].value){var S=p[i].value;if(g=""!==m[i].value?m[i].value:S,d.push("KUA"),document.querySelector("#funnelList datalist option[value='"+p[i].value+"']")){let e=document.querySelector("#funnelList datalist option[value='"+p[i].value+"']").dataset.value.split("~~");A=e[0],f=e[2],E=e[3]}else f=h[i].value,"Advanced"==t&&(t="Simple",document.querySelector("#bottomDARBIE").innerText='You have chosen the "Advanced" option for dashboarding, but this option does not support non-key user actions. We will automatically deploy a simple version instead. You can configure this again and choose to use only Key User Actions to get a more advanced version of the funnel dashboard.',document.querySelector('a[href="#bottomDARBIE"]').click());r.push(A),l.push(S),o.push(f),a.push(g),c.push(E)}if(""!==b[i].value){S=b[i].value;if(g=""!==m[i].value?m[i].value:S,d.push("CG"),document.querySelector("#funnelList datalist option[value='"+b[i].value+"']")){let e=document.querySelector("#funnelList datalist option[value='"+b[i].value+"']").dataset.value.split("~~");A=e[0],f=e[2],E=e[3]}r.push(A),l.push(S),o.push(f),a.push(g),c.push(E)}}for(i=0;i<l.length;i++){let e=r[i],p=l[i],b=o[i],h=a[i],m=c[i];if(n.tiles.push({name:h,tileType:"HEADER",configured:!0,bounds:{top:380,left:s,width:228,height:38},tileFilter:{}}),n.tiles.push({name:h,tileType:"HEADER",configured:!0,bounds:{top:760,left:s,width:228,height:38},tileFilter:{}}),"Advanced"==t){let t="",i="",a="";"Xhr"==m?(t=e+"Â¦APPLICATION_METHODÂ»"+e+"Â»truebuiltin:apps.web.action.duration.xhr.browser|AVG|TOTAL|LINE|APPLICATION_METHOD",i="builtin:apps.web.action.duration.xhr.browser",a="Action Duration"):"Load"==m&&(t=e+"Â¦APPLICATION_METHODÂ»"+e+"Â»truebuiltin:apps.web.action.visuallyComplete.load.browser|AVG|TOTAL|LINE|APPLICATION_METHOD",i="builtin:apps.web.action.visuallyComplete.load.browser",a="Visually Complete"),n.tiles.push({name:"Custom chart",tileType:"CUSTOM_CHARTING",configured:!0,bounds:{top:1558,left:u,width:304,height:304},tileFilter:{},filterConfig:{type:"MIXED",customName:a,defaultName:"Custom chart",chartConfig:{legendShown:!0,type:"TIMESERIES",series:[{metric:i,aggregation:"AVG",type:"LINE",entityType:"APPLICATION_METHOD",dimensions:[{id:"0",name:"dt.entity.application_method",values:[],entityDimension:!0}],sortAscending:!1,sortColumn:!0,aggregationRate:"TOTAL"}],resultMetadata:{[t]:{lastModified:1596474220684,customColor:"#7b379f"}}},filtersPerEntityType:{APPLICATION_METHOD:{SPECIFIC_ENTITIES:[e]}}}});let r=e+"Â¦APPLICATION_METHODÂ»"+e+"Â»truebuiltin:apps.web.action.apdex|AVG|TOTAL|LINE|APPLICATION_METHOD";n.tiles.push({name:"Custom chart",tileType:"CUSTOM_CHARTING",configured:!0,bounds:{top:2166,left:u,width:304,height:228},tileFilter:{},filterConfig:{type:"MIXED",customName:"Apdex",defaultName:"Custom chart",chartConfig:{legendShown:!0,type:"SINGLE_VALUE",series:[{metric:"builtin:apps.web.action.apdex",aggregation:"AVG",type:"LINE",entityType:"APPLICATION_METHOD",dimensions:[{id:"0",name:"dt.entity.application_method",values:[],entityDimension:!0}],sortAscending:!1,sortColumn:!1,aggregationRate:"TOTAL"}],resultMetadata:{[r]:{lastModified:1596474985523,customColor:"#7b379f"}}},filtersPerEntityType:{APPLICATION_METHOD:{SPECIFIC_ENTITIES:[e]}}}});let o=e+"Â¦APPLICATION_METHODÂ»"+e+"Â»trueÂ¦Error typeÂ»JavaScriptÂ»falsebuiltin:apps.web.action.countOfErrors|NONE|TOTAL|LINE|APPLICATION_METHOD",l=e+"Â¦APPLICATION_METHODÂ»"+e+"Â»trueÂ¦Error typeÂ»HTTPÂ»falsebuiltin:apps.web.action.countOfErrors|NONE|TOTAL|LINE|APPLICATION_METHOD";n.tiles.push({name:"Custom chart",tileType:"CUSTOM_CHARTING",configured:!0,bounds:{top:1862,left:u,width:304,height:304},tileFilter:{},filterConfig:{type:"MIXED",customName:"HTTP & JS Errors",defaultName:"Custom chart",chartConfig:{legendShown:!0,type:"TIMESERIES",series:[{metric:"builtin:apps.web.action.countOfErrors",aggregation:"NONE",type:"LINE",entityType:"APPLICATION_METHOD",dimensions:[{id:"0",name:"dt.entity.application_method",values:[],entityDimension:!0},{id:"2",name:"Error type",values:[],entityDimension:!1}],sortAscending:!1,sortColumn:!0,aggregationRate:"TOTAL"}],resultMetadata:{[o]:{lastModified:1597349772546,customColor:"#f5d30f"},[l]:{lastModified:1597349767861,customColor:"#ff0010"}}},filtersPerEntityType:{APPLICATION_METHOD:{SPECIFIC_ENTITIES:[e]}}}})}let A='SELECT avg(visuallyCompleteTime) AS "Viz Complete" FROM useraction WHERE ';"KUA"==d[i]?A+='useraction.name="'+p+'" AND application="'+b+'"':A+='useraction.matchingConversionGoals="'+p+'" AND application="'+b+'"',n.tiles.push({name:"User Sessions Query for VC",tileType:"DTAQL",configured:!0,bounds:{top:950,left:u,width:152,height:152},tileFilter:{},customName:p,query:A,type:"SINGLE_VALUE",timeFrameShift:"dynamic",limit:50});let f='SELECT SUM(errorCount) AS "Errors" FROM useraction WHERE ';"KUA"==d[i]?f+='useraction.name="'+p+'" AND application="'+b+'"':f+='useraction.matchingConversionGoals="'+p+'" AND application="'+b+'"',n.tiles.push({name:"User Sessions Query for Errors",tileType:"DTAQL",configured:!0,bounds:{top:950,left:u+152,width:152,height:152},tileFilter:{},customName:p,query:f,type:"SINGLE_VALUE",timeFrameShift:"dynamic",limit:50});let E='SELECT apdexCategory AS "Apdex", count(*) FROM useraction WHERE ';if("KUA"==d[i]?E+='useraction.name="'+p+'" AND application="'+b+'"':E+='useraction.matchingConversionGoals="'+p+'" AND application="'+b+'"',n.tiles.push({name:"User Sessions Query for Apdex",tileType:"DTAQL",configured:!0,bounds:{top:1254,left:u,width:304,height:304},tileFilter:{},customName:p,query:E+=" GROUP BY apdexCategory",type:"PIE_CHART",limit:50}),l[i+1]){let e='SELECT COUNT(*) AS "Abandoned Sessions" FROM usersession WHERE useraction.isExitAction=true AND';for(x=0;x<=i;x++)"KUA"==d[x]?e+='((useraction.application="'+o[x]+'" AND useraction.name="'+l[x]+'")) AND ':e+='((useraction.application="'+o[x]+'" AND useraction.matchingConversionGoals="'+l[x]+'")) AND ';d[i+1],e+='NOT ((useraction.application="'+o[i+1]+'" and useraction.name="'+l[i+1]+'"))',n.tiles.push({name:"User Sessions Query for Abandons",tileType:"DTAQL",configured:!0,bounds:{top:1102,left:u,width:304,height:152},tileFilter:{},customName:l[i],query:e,type:"SINGLE_VALUE",timeFrameShift:"dynamic",limit:50})}else n.tiles.push({name:"Markdown No Abandons",tileType:"MARKDOWN",configured:!0,bounds:{top:1102,left:u,width:304,height:152},tileFilter:{},markdown:" â€Žâ€Ž\nâ€Ž\n\n# N/A\nEnd of funnel\n\\\nNo abandons available"});let g='SELECT count(*) AS "Conversions" from usersession WHERE ';for(y=0;y<=i;y++)0==y?"KUA"==d[y]?g+='((useraction.application = "'+o[y]+'" AND useraction.name="'+l[y]+'"))':g+='((useraction.application = "'+o[y]+'" AND useraction.matchingConversionGoals="'+l[y]+'"))':"KUA"==d[y]?g+=' AND ((useraction.application = "'+o[y]+'" AND useraction.name="'+l[y]+'"))':g+=' AND ((useraction.application = "'+o[y]+'" AND useraction.matchingConversionGoals="'+l[y]+'"))';n.tiles.push({name:"User Sessions Query for Conversions",tileType:"DTAQL",configured:!0,bounds:{top:798,left:u,width:304,height:152},tileFilter:{},customName:l[i],query:g,type:"SINGLE_VALUE",timeFrameShift:"dynamic",limit:50}),s+=304,u+=304}"Advanced"==t&&n.tiles.push({name:"Markdown Performance Icon",tileType:"MARKDOWN",configured:!0,bounds:{top:1634,left:0,width:228,height:114},tileFilter:{},markdown:"\n# â±ï¸ Performance\n\n"},{name:"Markdown Errors Icon",tileType:"MARKDOWN",configured:!0,bounds:{top:1938,left:0,width:228,height:114},tileFilter:{},markdown:"\n# ðŸ’£ Errors\n"}),n.tiles.push({name:"Markdown Apdex Icon",tileType:"MARKDOWN",configured:!0,bounds:{top:1368,left:0,width:228,height:114},tileFilter:{},markdown:"\n# ðŸ™‚ðŸ™ Apdex\n\n"},{name:"Markdown Overview Icon",tileType:"MARKDOWN",configured:!0,bounds:{top:912,left:0,width:228,height:114},tileFilter:{},markdown:"\n# ðŸ”Ž Overview"},{name:"Markdown Abandons",tileType:"MARKDOWN",configured:!0,bounds:{top:1178,left:0,width:228,height:114},tileFilter:{},markdown:"\n# ðŸ’¨ Abandons"});let O="SELECT FUNNEL(";for(i=0;i<l.length;i++)"KUA"==d[i]?O+='((useraction.application="'+o[i]+'" and useraction.name="'+l[i]+'")) as "'+a[i]+'"':O+='((useraction.application="'+o[i]+'" and useraction.matchingConversionGoals="'+l[i]+'")) as "'+a[i]+'"',l[i+1]?O+=",":O+=") from usersession";n.tiles.push({name:"User Sessions Query for Funnel",tileType:"DTAQL",configured:!0,bounds:{top:418,left:228,width:304*l.length,height:342},tileFilter:{},customName:"Account Conversion Funnel",query:O,type:"FUNNEL",limit:50});let T='select count(*) as "Conversions" FROM usersession where ';for(i=0;i<l.length;i++)"KUA"==d[i]?T+='((useraction.application="'+o[i]+'" and useraction.name="'+l[i]+'"))':T+='((useraction.application="'+o[i]+'" and useraction.matchingConversionGoals="'+l[i]+'"))',l[i+1]&&(T+=" AND ");n.tiles.push({name:"User Sessions Query for Total Conversions",tileType:"DTAQL",configured:!0,bounds:{top:228,left:228,width:342,height:152},tileFilter:{},customName:"Conversions",query:T,type:"SINGLE_VALUE",timeFrameShift:"dynamic",limit:50});let D='select count(*) as "Satisfied Conversions" FROM usersession where ';for(i=0;i<l.length;i++)"KUA"==d[i]?D+='((useraction.application="'+o[i]+'" and useraction.name="'+l[i]+'"))':D+='((useraction.application="'+o[i]+'" and useraction.matchingConversionGoals="'+l[i]+'"))',l[i+1]?D+=" AND ":D+=' and userExperienceScore="SATISFIED"';n.tiles.push({name:"User Sessions Query for Total Satisfied Conversions",tileType:"DTAQL",configured:!0,bounds:{top:228,left:570,width:304,height:152},tileFilter:{},customName:"Satisfied",query:D,type:"SINGLE_VALUE",timeFrameShift:"dynamic",limit:50});let I='select count(*) as "Tolerated Conversions" FROM usersession where ';for(i=0;i<l.length;i++)"KUA"==d[i]?I+='((useraction.application="'+o[i]+'" and useraction.name="'+l[i]+'"))':I+='((useraction.application="'+o[i]+'" and useraction.matchingConversionGoals="'+l[i]+'"))',l[i+1]?I+=" AND ":I+=' and userExperienceScore="TOLERATED"';n.tiles.push({name:"User Sessions Query for Total Tolerated Conversions",tileType:"DTAQL",configured:!0,bounds:{top:228,left:874,width:304,height:152},tileFilter:{},customName:"Tolerated",query:I,type:"SINGLE_VALUE",timeFrameShift:"dynamic",limit:50});let C='select count(*) as "Frustrated Conversions" FROM usersession where ';for(i=0;i<l.length;i++)"KUA"==d[i]?C+='((useraction.application="'+o[i]+'" and useraction.name="'+l[i]+'"))':C+='((useraction.application="'+o[i]+'" and useraction.matchingConversionGoals="'+l[i]+'"))',l[i+1]?C+=" AND ":C+=' and userExperienceScore="FRUSTRATED"';return n.tiles.push({name:"User Sessions Query for Total Frustrated Conversions",tileType:"DTAQL",configured:!0,bounds:{top:228,left:1178,width:304,height:152},tileFilter:{},customName:"Frustrated",query:C,type:"SINGLE_VALUE",timeFrameShift:"dynamic",limit:50}),n.id="00000008-bbbb-dddd-aaaa-"+e,n.dashboardMetadata.owner=dataObject.User,document.querySelector('input[placeholder^="Enter the name for your funnel dashboard"]').value.length>0?(n.dashboardMetadata.name=document.querySelector('input[placeholder^="Enter the name for your funnel dashboard"]').value,n.tiles.push({name:"Markdown Funnel Icon",tileType:"MARKDOWN",configured:!0,bounds:{top:456,left:0,width:228,height:152},tileFilter:{},markdown:"\n# ðŸ "+document.querySelector('input[placeholder^="Enter the name for your funnel dashboard"]').value})):n.tiles.push({name:"Markdown Funnel Icon",tileType:"MARKDOWN",configured:!0,bounds:{top:456,left:0,width:228,height:152},tileFilter:{},markdown:"\n# ðŸ Funnel\n\n"}),n}let listenerOrder={};function parseAppAndSynthDARBIE(){if(Object.keys(dataObject.applications).length>0){let e={};Object.keys(dataObject.applications).sort().forEach(function(t){e[t]=dataObject.applications[t]});let t=document.querySelector("#appBodyDARBIE"),i=document.createElement("div");i.setAttribute("class","form-check justify-content-end");let n=document.createElement("input");n.setAttribute("class","form-check-input"),n.setAttribute("id","clearbox"),n.setAttribute("type","checkbox"),n.addEventListener("click",function(t){let i=document.querySelectorAll(".justify-content-end input[type='checkbox']");for(let n in i){t.currentTarget.checked?i[n].checked=!0:i[n].checked=!1;for(let i in e){let n=document.querySelectorAll(`#${e[i]}-KUA input`);for(let e=0;e<n.length;e++)t.currentTarget.checked?n[e].checked=!0:n[e].checked=!1;let a=document.querySelectorAll(`#${e[i]}-CG input`);for(let e=0;e<a.length;e++)t.currentTarget.checked?(a[e].checked=!0,a[e].disabled=!1):a[e].checked=!1}}}),i.appendChild(n);let a=document.createElement("label");if(a.setAttribute("class","form-check-label"),a.setAttribute("for","clearbox"),a.innerText="Select/Clear All",i.appendChild(a),t.appendChild(i),Object.keys(dataObject.applications).length>0){let e={};Object.keys(dataObject.applications).sort().forEach(function(t){e[t]=dataObject.applications[t]});for(let t in e)dataObject.applications.hasOwnProperty(t)&&createApplicationInputDARBIE(t,dataObject.applications[t],dataObject.KUAs[t],dataObject.conversionGoals[t])}}if(Object.keys(dataObject.monitors).length>0){let e={};Object.keys(dataObject.monitors).sort().forEach(function(t){e[t]=dataObject.monitors[t]});let t=document.querySelector("#synthBodyDARBIE"),i=document.createElement("div");i.setAttribute("class","form-check d-flex");let n=document.createElement("input");n.setAttribute("class","form-check-input"),n.setAttribute("id","clearbox"),n.setAttribute("type","checkbox"),n.addEventListener("click",function(t){let i=document.querySelectorAll("#synthTestDARBIE input[type='checkbox']");for(let e in i)t.currentTarget.checked?i[e].checked=!0:i[e].checked=!1;for(let i in e)if(e.hasOwnProperty(i)){const n=`#${e[i].id}DARBIE input`;checkListener(t.currentTarget.checked,n)}}),i.appendChild(n);let a=document.createElement("label");a.setAttribute("class","form-check-label"),a.setAttribute("for","clearbox"),a.innerText="Select/Clear All",i.appendChild(a),t.appendChild(i);for(let t in e)e.hasOwnProperty(t)&&createSyntheticInputDARBIE(t,e[t].id)}let e=document.querySelector("#insightsDARBIE"),t=document.createElement("div");if(t.setAttribute("class","form-check d-flex"),Object.keys(dataObject.dashboards_insights).length>0){let i=document.createElement("input");i.setAttribute("class","form-check-input"),i.setAttribute("id","DBclearbox"),i.setAttribute("type","checkbox"),i.addEventListener("click",function(e){let t=document.querySelectorAll("#insightsDARBIE input[type='checkbox']");for(let i in t)e.currentTarget.checked?t[i].checked=!0:t[i].checked=!1;document.querySelector('.panel div[id^="list"] input:checked')?(document.querySelector("#deleteDARBIE").disabled=!1,document.querySelector("#overwriteDARBIE").disabled=!1):(document.querySelector("#deleteDARBIE").disabled=!0,document.querySelector("#overwriteDARBIE").disabled=!0)}),t.appendChild(i);let n=document.createElement("label");n.setAttribute("class","form-check-label"),n.setAttribute("for","DBclearbox"),n.innerText="Select/Clear All",t.appendChild(n),e.appendChild(t)}let i={};Object.keys(dataObject.dashboards_insights).sort().forEach(function(e){i[e]=dataObject.dashboards_insights[e]});let n=i;for(let e in n)if(-1!==e.indexOf("-bbbb-dddd-aaaa-")){createdApplications[e]=n[e];let t=document.querySelectorAll(".justify-content-end input");for(let i in t)if(t[i].parentElement instanceof HTMLElement&&t[i].parentElement.id.indexOf("APPLICATION-")>-1){let a=t[i].parentElement.querySelector("label").title.split(" - (")[0];n[e].indexOf(a)>-1&&(t[i].parentElement.children[1].style.color="#43BA26",t[i].parentElement.children[1].style.fontWeight="bold")}let i=document.querySelector("#insightsDARBIE"),a=document.createElement("div");a.setAttribute("class","form-check d-flex"),a.setAttribute("id","listinsightsDARBIE");let r=document.createElement("input");r.setAttribute("class","form-check-input"),r.setAttribute("id",e),r.setAttribute("type","checkbox"),r.addEventListener("change",function(e){document.querySelector('.panel div[id^="list"] input:checked')?(document.querySelector("#deleteDARBIE").disabled=!1,document.querySelector("#overwriteDARBIE").disabled=!1):(document.querySelector("#deleteDARBIE").disabled=!0,document.querySelector("#overwriteDARBIE").disabled=!0)}),a.appendChild(r);let o=document.createElement("label");o.setAttribute("class","form-check-label"),o.setAttribute("for",e),o.innerText=`${n[e]} - (${e})`,a.appendChild(o),i.appendChild(a);let l=document.createElement("div");l.setAttribute("class","form-check");let d=document.createElement("label");d.setAttribute("class","form-check-label"),d.setAttribute("for","stepClearboxDARBIE"),d.innerText="Select/Clear All",l.appendChild(d)}let a=document.querySelector("#customersBodyDARBIE"),r=document.createElement("div");if(r.setAttribute("class","form-check d-flex"),Object.keys(dataObject.dashboards_customers).length>0){let e=document.createElement("input");e.setAttribute("class","form-check-input"),e.setAttribute("id","DBclearbox"),e.setAttribute("type","checkbox"),e.addEventListener("click",function(e){let t=document.querySelectorAll("#customersBodyDARBIE input[type='checkbox']");for(let i in t)e.currentTarget.checked?t[i].checked=!0:t[i].checked=!1;document.querySelector('.panel div[id^="list"] input:checked')?(document.querySelector("#deleteDARBIE").disabled=!1,document.querySelector("#overwriteDARBIE").disabled=!1):(document.querySelector("#deleteDARBIE").disabled=!0,document.querySelector("#overwriteDARBIE").disabled=!0)}),r.appendChild(e);let t=document.createElement("label");t.setAttribute("class","form-check-label"),t.setAttribute("for","DBclearbox"),t.innerText="Select/Clear All",r.appendChild(t),a.appendChild(r)}let o={};Object.keys(dataObject.dashboards_customers).sort().forEach(function(e){o[e]=dataObject.dashboards_customers[e]});let l=o;for(d in l){let e=document.querySelector("#customersBodyDARBIE"),t=document.createElement("div");t.setAttribute("class","form-check d-flex"),t.setAttribute("id","listCustomersDARBIE");let i=document.createElement("input");i.setAttribute("class","form-check-input"),i.setAttribute("id",d),i.setAttribute("type","checkbox"),i.addEventListener("change",function(e){document.querySelector('.panel div[id^="list"] input:checked')?(document.querySelector("#deleteDARBIE").disabled=!1,document.querySelector("#overwriteDARBIE").disabled=!1):(document.querySelector("#deleteDARBIE").disabled=!0,document.querySelector("#overwriteDARBIE").disabled=!0)}),t.appendChild(i);let n=document.createElement("label");n.setAttribute("class","form-check-label"),n.setAttribute("for",d),n.innerText=`${l[d]} - (${d})`,t.appendChild(n),e.appendChild(t);let a=document.createElement("div");a.setAttribute("class","form-check");let r=document.createElement("label");r.setAttribute("class","form-check-label"),r.setAttribute("for","stepClearboxDARBIE"),r.innerText="Select/Clear All",a.appendChild(r)}let c=document.querySelector("#otherDTBodyDARBIE"),s=document.createElement("div");if(s.setAttribute("class","form-check d-flex"),Object.keys(dataObject.dashboards_otherdt).length>0){let e=document.createElement("input");e.setAttribute("class","form-check-input"),e.setAttribute("id","DBclearbox"),e.setAttribute("type","checkbox"),e.addEventListener("click",function(e){let t=document.querySelectorAll("#otherDTBodyDARBIE input[type='checkbox']");for(let i in t)e.currentTarget.checked?t[i].checked=!0:t[i].checked=!1;document.querySelector('.panel div[id^="list"] input:checked')?(document.querySelector("#deleteDARBIE").disabled=!1,document.querySelector("#overwriteDARBIE").disabled=!1):(document.querySelector("#deleteDARBIE").disabled=!0,document.querySelector("#overwriteDARBIE").disabled=!0)}),s.appendChild(e);let t=document.createElement("label");t.setAttribute("class","form-check-label"),t.setAttribute("for","DBclearbox"),t.innerText="Select/Clear All",s.appendChild(t),c.appendChild(s)}let u={};Object.keys(dataObject.dashboards_otherdt).sort().forEach(function(e){u[e]=dataObject.dashboards_otherdt[e]});let p=u;for(d in p){let e=document.querySelector("#otherDTBodyDARBIE"),t=document.createElement("div");t.setAttribute("class","form-check d-flex"),t.setAttribute("id","listotherDTDARBIE");let i=document.createElement("input");i.setAttribute("class","form-check-input"),i.setAttribute("id",d),i.setAttribute("type","checkbox"),i.addEventListener("change",function(e){document.querySelector('.panel div[id^="list"] input:checked')?(document.querySelector("#deleteDARBIE").disabled=!1,document.querySelector("#overwriteDARBIE").disabled=!1):(document.querySelector("#deleteDARBIE").disabled=!0,document.querySelector("#overwriteDARBIE").disabled=!0)}),t.appendChild(i);let n=document.createElement("label");n.setAttribute("class","form-check-label"),n.setAttribute("for",d),n.innerText=`${p[d]} - (${d})`,t.appendChild(n),e.appendChild(t);let a=document.createElement("div");a.setAttribute("class","form-check");let r=document.createElement("label");r.setAttribute("class","form-check-label"),r.setAttribute("for","stepClearboxDARBIE"),r.innerText="Select/Clear All",a.appendChild(r)}}function createApplicationInputDARBIE(e,t,i,n){let a=document.querySelector("#appBodyDARBIE"),r=document.createElement("div");r.setAttribute("class","form-check justify-content-end"),r.setAttribute("style","margin-top:20px;"),r.setAttribute("id",t+"DARBIE");let o=document.createElement("input");o.setAttribute("class","form-check-input"),o.setAttribute("type","checkbox"),o.addEventListener("change",function(e){let i=document.querySelectorAll(`#${t}-KUA input`);for(let n in i)e.currentTarget.checked?i[n].checked=!0:i[n].checked=!1,void 0!==i[n].id&&-1===i[n].id.indexOf("Clear")&&saveEventOrder(e,"KUAs",t,i[n].id);let n=document.querySelectorAll(`#${t}-CG input`);for(let i in n)e.currentTarget.checked?n[i].checked=!0:n[i].checked=!1,void 0!==n[i].id&&-1===n[i].id.indexOf("Clear")&&saveEventOrder(e,"CGs",t,n[i].id)}),r.appendChild(o);let l=document.createElement("label");if(l.setAttribute("class","form-check-label"),l.setAttribute("for",t+"DARBIE"),l.setAttribute("title",`${e} - (${t.split("-")[1]})`),e.length>=20){let i=e.trimExcess(20);l.innerText=`${i} - (${t.split("-")[1]})`}else l.innerText=`${e} - (${t.split("-")[1]})`;if(r.appendChild(l),i){let e=document.createElement("button");e.setAttribute("class","btn btn-outline-primary btn-sm float-right"),e.setAttribute("type","button"),e.setAttribute("style","margin-left: 5px;"),e.setAttribute("data-toggle","collapse"),e.setAttribute("data-target",`#${t}-KUA`),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-controls",t+"-KUA"),e.innerText="Show Key UAs",r.appendChild(e)}else{let e=document.createElement("button");e.setAttribute("class","btn btn-outline-primary btn-sm float-right"),e.setAttribute("type","button"),e.setAttribute("style","margin-left: 5px; width: 102px; color:#ff0000; border-color:#ff0000"),e.setAttribute("data-toggle","collapse"),e.setAttribute("aria-expanded","false"),e.setAttribute("disabled","true"),e.innerText="No Key UAs",r.appendChild(e)}if(n){let e=document.createElement("button");e.setAttribute("class","btn btn-outline-primary btn-sm float-right"),e.setAttribute("type","button"),e.setAttribute("style","margin-left: 5px;"),e.setAttribute("data-toggle","collapse"),e.setAttribute("data-target",`#${t}-CG`),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-controls",t+"-CG"),e.innerText="Show Conversion Goals",r.appendChild(e)}else{let e=document.createElement("button");e.setAttribute("class","btn btn-outline-primary btn-sm float-right"),e.setAttribute("type","button"),e.setAttribute("style","margin-left: 5px; width: 158px; color:#ff0000; border-color:#ff0000"),e.setAttribute("data-toggle","collapse"),e.setAttribute("aria-expanded","false"),e.setAttribute("disabled","true"),e.innerText="No Conversion Goals",r.appendChild(e)}a.appendChild(r);let d=document.createElement("div");d.setAttribute("class","collapse"),d.setAttribute("id",t+"-KUA");let c=document.createElement("div");c.setAttribute("class","card card-body"),c.setAttribute("style","margin-top:20px;");let s=document.createElement("div");s.setAttribute("class","form-check");let u=document.createElement("input");u.setAttribute("class","form-check-input"),u.setAttribute("id","KUAClearbox"),u.setAttribute("type","checkbox"),u.addEventListener("click",function(e){let i=document.querySelectorAll(`#${t}-KUA input[type='checkbox']`);for(let n in i)void 0!==i[n].id&&-1===i[n].id.indexOf("Clear")&&saveEventOrder(e,"KUAs",t,i[n].id),e.currentTarget.checked?(i[n].checked=!0,document.querySelector(`#${t}DARBIE`).firstChild.checked=!0):i[n].checked=!1}),s.appendChild(u);let p=document.createElement("label");p.setAttribute("class","form-check-label"),p.setAttribute("for","KUAClearbox"),p.innerText="Select/Clear All",s.appendChild(p),c.appendChild(s);for(let e in i)if(i.hasOwnProperty(e)){let n=document.createElement("div");n.setAttribute("class","form-check");let a=document.createElement("input");a.setAttribute("class","form-check-input"),a.setAttribute("id",i[e].id),a.setAttribute("DTName",i[e].actionName),a.setAttribute("DTType",i[e].actionType),a.setAttribute("type","checkbox"),a.addEventListener("click",function(n){void 0!==i[e].id&&-1===i[e].id.indexOf("Clear")&&saveEventOrder(n,"KUAs",t,i[e].id),n.currentTarget.checked&&(document.querySelector(`#${t}DARBIE`).firstChild.checked=!0,document.querySelector(`#${t}`).checked=!0)}),n.appendChild(a);let r=document.createElement("label");r.setAttribute("class","form-check-label"),r.setAttribute("for",i[e].id),r.innerText=`${i[e].actionName} - (${i[e].actionType}) - ${i[e].id}`,n.appendChild(r),c.appendChild(n),d.appendChild(c)}a.appendChild(d);let b=document.createElement("div");b.setAttribute("class","collapse"),b.setAttribute("id",t+"-CG");let h=document.createElement("div");h.setAttribute("class","card card-body"),h.setAttribute("style","margin-top:20px;");let m=document.createElement("div");m.setAttribute("class","form-check");let A=document.createElement("input");A.setAttribute("class","form-check-input"),A.setAttribute("id","CGClearbox"),A.setAttribute("type","checkbox"),A.addEventListener("click",function(e){let i=document.querySelectorAll(`#${t}-CG input[type='checkbox']`);for(let n in i)void 0!==i[n].id&&-1===i[n].id.indexOf("Clear")&&saveEventOrder(e,"CGs",t,i[n].id),e.currentTarget.checked?(i[n].checked=!0,document.querySelector(`#${t}DARBIE`).firstChild.checked=!0):i[n].checked=!1}),m.appendChild(A);let f=document.createElement("label");f.setAttribute("class","form-check-label"),f.setAttribute("for","CGClearbox"),f.innerText="Select/Clear All",m.appendChild(f),h.appendChild(m);for(let e in n)if(n.hasOwnProperty(e)){let i=document.createElement("div");i.setAttribute("class","form-check");let a=document.createElement("input");a.setAttribute("class","form-check-input"),a.setAttribute("id",n[e].id),a.setAttribute("DTName",n[e].name),a.setAttribute("DTType",n[e].actionType),a.setAttribute("type","checkbox"),a.addEventListener("click",function(i){void 0!==n[e].id&&-1===n[e].id.indexOf("Clear")&&saveEventOrder(i,"CGs",t,n[e].id),i.currentTarget.checked&&(document.querySelector(`#${t}`).checked=!0,document.querySelector(`#${t}DARBIE`).firstChild.checked=!0)}),i.appendChild(a);let r=document.createElement("label");r.setAttribute("class","form-check-label"),r.setAttribute("for",n[e].id),r.innerText=`${n[e].name} - ${n[e].id}`,i.appendChild(r),h.appendChild(i),b.appendChild(h)}a.appendChild(b)}function createSyntheticInputDARBIE(e,t){let i=document.querySelector("#synthBodyDARBIE"),n=document.createElement("div");n.setAttribute("class","form-check d-flex"),n.setAttribute("id","synthTestDARBIE");let a=document.createElement("input");a.setAttribute("class","form-check-input"),a.setAttribute("id",t),a.setAttribute("type","checkbox"),a.addEventListener("change",function(e){const i=`#${t}DARBIE input`;checkListener(e.currentTarget.checked,i)}),n.appendChild(a);let r=document.createElement("label");r.setAttribute("class","form-check-label"),r.setAttribute("for",t),r.innerText=`${e} - (${t.split("-")[1]})`,n.appendChild(r),i.appendChild(n);let o=document.createElement("div");o.setAttribute("class","form-check");let l=document.createElement("label");l.setAttribute("class","form-check-label"),l.setAttribute("for","stepClearboxDARBIE"),l.innerText="Select/Clear All",o.appendChild(l)}function saveEventOrder(e,t,i,n){e.currentTarget.checked?(listenerOrder[i]||(listenerOrder[i]={},listenerOrder[i].CGs=[],listenerOrder[i].KUAs=[]),-1===listenerOrder[i][t].indexOf(n)&&listenerOrder[i][t].push(n)):(listenerOrder[i]||(listenerOrder[i]={},listenerOrder[i].CGs=[],listenerOrder[i].KUAs=[]),-1!==listenerOrder[i][t].indexOf(n)&&listenerOrder[i][t].splice(listenerOrder[i][t].indexOf(n),1))}function configureDashboards(e){if(""!==document.getElementById("apiTokenDARBIE").value){let t=!1;if(dataObject.managed){let e=dataObject.fullURL.split("/e/");dataObject.fullURL=e[0]+"/e/"+e[1].split("/")[0]}else dataObject.fullURL=dataObject.fullURL.split(".com")[0]+".com";let i=!1,n=!1,a=document.querySelectorAll('#appBodyDARBIE div[id$="-KUA"] input[id^="APPLICATION_METHOD"]');for(let e=0;e<a.length;e++)a[e].checked&&(i=!0);let r=document.querySelectorAll("#synthBodyDARBIE input");for(let e=0;e<r.length;e++)r[e].id.indexOf("SYNTHETIC_TEST-")>-1&&r[e].checked&&(n=!0);for(let e in dataObject.dashboards_insights)if(foundDashboards[e.split("-")[0]]||0===foundDashboards[e.split("-")[0]]){let t=parseInt(foundDashboards[e.split("-")[0]]),i=parseInt(e.split("-")[e.split("-").length-1]);i>t&&(foundDashboards[e.split("-")[0]]=i)}return new Promise((a,r)=>{let o=dataObject.dashboards_insights;if(i){let i=document.querySelectorAll(".justify-content-end input");for(let n in i)if(i[n].checked){let a=null,r=null,l=null;if(i[n].parentElement instanceof HTMLElement&&i[n].parentElement.id.indexOf("APPLICATION-")>-1){let d=i[n].parentElement.querySelector("label").title.split(" - (")[0],c=i[n].parentElement.id.split("DARBIE")[0],s=document.querySelectorAll(`div[id="${c}-KUA"] input[id^="APPLICATION_METHOD"]:checked`);if(0==s.length&&(t=!0),s.length>42&&(document.querySelector("#bottomDARBIE").innerText="You have selected more than 42 KUAs for one application. 42 is the maximum we can deploy. Please remove some to continue with the KUA dashboard deployment.",document.querySelector('a[href="#bottomDARBIE"]').click(),t=!0),"Overwrite"===e)for(let e in o)o[e].indexOf(d)>-1&&("00000002"===e.split("-")[0]&&(a=e.split("-")[e.split("-").length-1]),"00000003"===e.split("-")[0]&&(r=e.split("-")[e.split("-").length-1]));else foundDashboards["00000002"]>0?(l=parseInt(foundDashboards["00000002"]),a=(a=l+=1).toString().padStart(8,"0")):a="00000001",foundDashboards["00000003"]>0?(l=parseInt(foundDashboards["00000003"]),r=(r=l+=1).toString().padStart(8,"0")):r="00000001";if(a||r||(document.querySelector("#bottomDARBIE").innerText="You chose to replace application dashboards, but did not select the correct application(s) from the RUM section!",document.querySelector('a[href="#bottomDARBIE"]').click(),t=!0),a&&r&&!1===t){let e=JSON.stringify(dAppOverview(a,r)),t=i[n].parentElement.id.split("DARBIE")[0],o=Object.keys(dataObject.applications).find(e=>dataObject.applications[e]===t);if(e=(e=e.split("APPLICATION-ID").join(t)).split("[Application Name]").join(o),foundDashboards["00000002"]=parseInt(a),requestAsync(dataObject.fullURL+"/api/config/v1/dashboards/00000002-bbbb-dddd-aaaa-"+a,"PUT",e),createdApplications["00000002-bbbb-dddd-aaaa-"+a]=o,listenerOrder[t]&&listenerOrder[t].KUAs){let e=JSON.stringify(dAppKUAs(r,a,listenerOrder[t].KUAs)),i=Object.keys(dataObject.applications).find(e=>dataObject.applications[e]===t);e=e.split("[Application Name]").join(i),foundDashboards["00000003"]=parseInt(r),requestAsync(dataObject.fullURL+"/api/config/v1/dashboards/00000003-bbbb-dddd-aaaa-"+r,"PUT",e)}}else(a&&!r||!a&&r)&&(document.querySelector("#bottomDARBIE").innerText="If you are replacing application dashboards, you must replace the application overview and the appropriate KUA dashboard for that application. If you are missing one or the other, delete the remaining one you have and generate new ones as they are meant to be a pair.",document.querySelector('a[href="#bottomDARBIE"]').click(),t=!0)}}}if(n){let i,n,a,r,o=document.querySelectorAll("#synthTestDARBIE input[type='checkbox']:checked"),l=document.querySelectorAll("#insightsDARBIE input");if("Overwrite"===e)for(let e in l)l[e].id&&l[e].checked&&(l[e].id.indexOf("00000004-")>-1&&(i=l[e].id.split("-")[l[e].id.split("-").length-1]),l[e].id.indexOf("00000005-")>-1&&(n=l[e].id.split("-")[l[e].id.split("-").length-1]),l[e].id.indexOf("00000006-")>-1&&(a=l[e].id.split("-")[l[e].id.split("-").length-1]));else foundDashboards["00000004"]>0?(r=parseInt(foundDashboards["00000004"]),i=r+=1,i=r.toString().padStart(8,"0")):i="00000001",foundDashboards["00000005"]>0?(r=parseInt(foundDashboards["00000005"]),n=(n=r+=1).toString().padStart(8,"0")):n="00000001",foundDashboards["00000006"]>0?(r=parseInt(foundDashboards["00000006"]),a=(a=r+=1).toString().padStart(8,"0")):a="00000001";if(i&&n&&a||(document.querySelector("#bottomDARBIE").innerText="You chose to replace synthetic dashboards but did not click either the synthetic dashboards, or the synthetic tests to replace them with!",document.querySelector('a[href="#bottomDARBIE"]').click(),t=!0),o.length>0&&!1===t)for(let e=0;e<o.length;e++){let t=o[e].getAttribute("id"),i=o[e].parentElement.lastChild.innerText.split(" - (")[0];listenerOrder.Synthetic?listenerOrder.Synthetic.length<64?listenerOrder.Synthetic.push([t,i]):(document.querySelector("#bottomDARBIE").innerText="We can only use a maximum of 64 synthetic tests for our dashboards. The first 64 that were chosen will be used, the rest will be ignored.",document.querySelector('a[href="#bottomDARBIE"]').click()):listenerOrder.Synthetic=[[t,i]]}if(listenerOrder.Synthetic&&!1===t&&(i&&(foundDashboards["00000004"]=parseInt(i)),n&&(foundDashboards["00000005"]=parseInt(n)),a&&(foundDashboards["00000006"]=parseInt(a)),n&&a&&i)){let e=JSON.stringify(dSyntheticPerf(n,i));requestAsync(dataObject.fullURL+"/api/config/v1/dashboards/00000005-bbbb-dddd-aaaa-"+n,"PUT",e);let t=JSON.stringify(dSyntheticAvail(a,i));requestAsync(dataObject.fullURL+"/api/config/v1/dashboards/00000006-bbbb-dddd-aaaa-"+a,"PUT",t);let r=JSON.stringify(dSyntheticMonitorView(i));requestAsync(dataObject.fullURL+"/api/config/v1/dashboards/00000004-bbbb-dddd-aaaa-"+i,"PUT",r)}}if(!1===t){let e=document.getElementById("analystEmailDARBIE").value;if(e.length>0&&e.indexOf("@")>-1){let t=JSON.stringify(dInsightsOverview(e));foundDashboards["00000007"]=parseInt("00000001"),requestAsync(dataObject.fullURL+"/api/config/v1/dashboards/00000007-bbbb-dddd-aaaa-00000001","PUT",t)}let t=JSON.stringify(dTenantOverview(createdApplications));requestAsync(dataObject.fullURL+"/api/config/v1/dashboards/00000001-bbbb-dddd-aaaa-00000001","PUT",t,createdApplications).then(function(e){e[0]>=200&&e[0]<400&&(document.querySelector("#generateDARBIE").innerText="Done!",document.querySelector("#generateDARBIE").disabled=!0)})}let l=document.querySelectorAll("#funnelList input.col-md-4"),d=0;for(choice of l)""!==choice.value&&d++;if(d>=3){if(foundDashboards["00000008"]>0){let e=parseInt(foundDashboards["00000008"]);funneldbID=e+=1,funneldbID=funneldbID.toString().padStart(8,"0")}else funneldbID="00000001";let e=document.querySelector("#simpleOpt").checked?"Simple":"Advanced";if(document.querySelector("#advOpt").checked){let t=document.querySelectorAll('input[list^="CGs"]');for(eachCG of t)""!==eachCG.value&&(document.querySelector("#bottomDARBIE").innerText='You have chosen the "Advanced" option for dashboarding, but this option does not support Conversion Goals. We will automatically deploy a simple version instead. You can configure this again and choose to use only Key User Actions to get a more advanced version of the funnel dashboard.',document.querySelector('a[href="#bottomDARBIE"]').click(),e="Simple")}let t=JSON.stringify(dFunnelDashboard(funneldbID,e));requestAsync(dataObject.fullURL+"/api/config/v1/dashboards/00000008-bbbb-dddd-aaaa-"+funneldbID,"PUT",t)}a()})}document.querySelector("#bottomDARBIE").innerText="Enter an API token first!",document.querySelector('a[href="#bottomDARBIE"]').click()}function gatherConfigInfoDARBIE(){let e=!1;return document.querySelectorAll('#appBodyDARBIE > div[id^="APPLICATION-"] > input:checked').length>=1?(document.querySelector("#funnelList").hidden=!1,e=!0):(document.querySelector("#appCheckDARBIE").innerText="No RUM application chosen.",document.querySelector("#funnelList").hidden=!0),new Promise((t,i)=>{if(e){let e=document.querySelectorAll(".justify-content-end input:checked"),t=Array.prototype.slice.call(e);t.length>4&&(t=t.slice(0,6));let i=document.querySelectorAll('datalist[id^="KUAorCGdatalist"]');for(eachFunnel of i)letUAOption=document.createElement("option"),letCGOption=document.createElement("option"),letUAOption.setAttribute("value","User Action"),letUAOption.innerHTML="User Action",letCGOption.setAttribute("value","Conversion Goal"),letCGOption.innerHTML="Conversion Goal",eachFunnel.appendChild(letUAOption),eachFunnel.appendChild(letCGOption);for(eachApp of t)if(eachApp.parentElement instanceof HTMLElement&&eachApp.parentElement.id.indexOf("APPLICATION-")>-1){let e=eachApp.parentElement.id.split("DARBIE")[0],t=Object.keys(dataObject.applications).find(t=>dataObject.applications[t]===e),i=document.querySelectorAll("#applicationCheckboxesDARBIE > li > label"),n=0;for(eachLabel of i){let e="";e=t.length>=30?t.trimExcess(20):t,eachLabel.innerText==e&&n++}if(0==n){let e=document.querySelector("#applicationCheckboxesDARBIE"),i=document.createElement("li");i.setAttribute("class","list-group-item flex-fill"),i.setAttribute("style","display: grid; grid-template-columns: 20px 0fr 0fr;");let n=document.createElement("input");n.setAttribute("class","list-group-item"),n.setAttribute("type","checkbox"),n.setAttribute("style","margin-top:3px; margin-left:10px");let a=[];n.addEventListener("click",function(e){if(e.currentTarget.checked){let e=document.querySelectorAll('datalist[id^="CGs"]');for(eachFunnel of e)if(dataObject.conversionGoals[t]&&dataObject.conversionGoals[t].length>0)for(listCG of dataObject.conversionGoals[t])if("UserAction"==listCG.type){let e=document.createElement("option"),i=eachFunnel;e.setAttribute("value",listCG.name),e.innerHTML=t,e.setAttribute("data-value",listCG.id+"~~"+dataObject.applications[t]+"~~"+t+"~~UserAction~~CG"),e.innerHTML=t,i.appendChild(e)}let i=document.querySelectorAll('datalist[id^="KUAs"]');for(eachFunnel of i){if(dataObject.KUAs[t]&&dataObject.KUAs[t].length>0)for(listKUA of dataObject.KUAs[t]){let e=document.createElement("option"),i=eachFunnel;e.setAttribute("value",listKUA.actionName),e.setAttribute("data-value",listKUA.id+"~~"+dataObject.applications[t]+"~~"+t+"~~"+listKUA.actionType+"~~KUA"),a.push(listKUA.id),e.innerHTML="Key User Action - "+t+" ("+listKUA.actionCount+" actions/min)",i.appendChild(e)}if(dataObject.NUAs[t]&&dataObject.NUAs[t].length>0)for(listNUA of dataObject.NUAs[t])if(-1===a.indexOf(listNUA.id)){let e=document.createElement("option"),i=eachFunnel;e.setAttribute("value",listNUA.actionName),e.setAttribute("data-value",listNUA.id+"~~"+dataObject.applications[t]+"~~"+t+"~~"+listNUA.actionType+"~~KUA"),e.innerHTML=t+" ("+listNUA.actionCount+" actions/min)",i.appendChild(e)}}let n=document.querySelectorAll('datalist[id^="Properties"]');for(eachProp of n)if(dataObject.appProperties[t]&&dataObject.appProperties[t].length>0)for(listProp of dataObject.appProperties[t]){let e=document.createElement("option"),i=eachProp;e.setAttribute("value",listProp.displayName),e.innerHTML=t+" ("+listProp.type+" - "+listProp.targets+")",i.appendChild(e)}let r=document.querySelectorAll('datalist[id^="funnelAppName"]');for(eachFunnel of r){let e=document.createElement("option");e.setAttribute("value",t),e.innerHTML=t,eachFunnel.appendChild(e)}}else{let t=e.currentTarget.nextSibling.title?e.currentTarget.nextSibling.title:e.currentTarget.nextSibling.innerText,i=document.querySelectorAll("#funnelList datalist option");for(opt of i)opt.innerText.indexOf(t+" - ")>-1&&opt.remove()}});let r=document.createElement("label");if(r.setAttribute("class","form-check-label"),r.setAttribute("style","margin-left:10px"),t.length>=30){let e=t.trimExcess(20);r.innerText=e,r.setAttribute("title",t)}else r.innerText=t;i.append(n),i.append(r),e.append(i)}}}})}function deleteDashboards(){if(dataObject.managed){let e=dataObject.fullURL.split("/e/");dataObject.fullURL=e[0]+"/e/"+e[1].split("/")[0]}else dataObject.fullURL=dataObject.fullURL.split(".com")[0]+".com";if(""!==document.getElementById("apiTokenDARBIE").value){let e=document.querySelectorAll('.panel div[id^="list"] input:checked');if(document.querySelector(".panel div#listCustomersDARBIE input:checked")){if(confirm("You have selected at least one dashboard from the customer facing dashboard section. Are you sure you want to delete them?")&&confirm("Are you absolutely sure you want to delete these dashboards?"))return new Promise((t,i)=>{for(let t=0;t<e.length;t++)requestAsync(dataObject.fullURL+"/api/config/v1/dashboards/"+e[t].id,"DELETE",null,e[t].id).then(function(e){e[0]>=200&&e[0]<400&&(document.querySelector('input[id="'+e[1]+'"]').parentElement.lastChild.innerText="Deleted!",document.querySelector('input[id="'+e[1]+'"]').disabled=!0)});t()})}else if(document.querySelector('.panel div[id^="list"] input:checked'))return new Promise((t,i)=>{for(let t=0;t<e.length;t++)requestAsync(dataObject.fullURL+"/api/config/v1/dashboards/"+e[t].id,"DELETE",null,e[t].id).then(function(e){e[0]>=200&&e[0]<400&&(document.querySelector('input[id="'+e[1]+'"]').parentElement.lastChild.innerText="Deleted!",document.querySelector('input[id="'+e[1]+'"]').disabled=!0)});t()})}else document.querySelector("#bottomDARBIE").innerText="Enter an API token first!",document.querySelector('a[href="#bottomDARBIE"]').click()}